<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>waze2gpx: Waze trip history to GPX converter</title>
        <script type="module" src="waze2gpx.js" defer></script>
        <link rel="stylesheet" href="layout.css">

        <!--
            xml-formatter
            https://github.com/chrisbottin/xml-formatter
            https://www.jsdelivr.com/package/npm/xml-formatter
        -->
        <script src="https://cdn.jsdelivr.net/npm/xml-formatter@3.6.3/dist/browser/xml-formatter-singleton.min.js"></script>

        <!-- 
            highlight.js
            https://highlightjs.org
        -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

        <!--
            Leaflet
            https://leafletjs.com/examples/quick-start/
        -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    </head>

    <body>
        <h1>Convert Waze trip history to GPX file</h1>

        <h2>Step 1: Export personal data from Waze</h2>
        <p>
            Request and download data archive from <a href="https://www.waze.com/account/download_data">https://www.waze.com/account/download_data</a>,<br/>
            then extract the "account_activity_3.csv" file from password-protected archive
        </p>

        <h2>Step 2: Upload the account_activity_3.csv file</h2>
        <form id="fileForm">
            <label for="fileUpload">Choose a account_activity_3.csv file:</label>
            <input type="file" id="fileUpload" name="fileUpload" accept=".csv">
            <button type="submit">Upload</button>
            <span id="fileFormErrorBox"></span>
        </form>

        <h2>Step 3: Trim data and adjust settings</h2>
        <p>
            <div>
                Start date: <input type="date" id="startDateInput" name="start-date" disabled />
                End date: <input type="date" id="endDateInput" name="end-date" disabled />
                Selected trips: <span id="selectedTripCounter"></span>
            </div>
            <div>
                <input type="checkbox" id="xmlFormatter" name="xmlFormatter" />
                <label for="xmlFormatter">Format XML (much slower conversion and 60% larger output file size)</label>
            </div>
        </p>

        <h2>Step 4: Download trip data in GPX format</h2>
        <p>
            <div>
                <button id="generateXmlButton" disabled>Generate GPX file</button>
                <span id="gpxFileLinkContainer">
                    GPX file: <a id="downloadXmlLink">account_activity_3.gpx</a>
                </span>
            </div>
        </p>
        <pre id="filePreviewContainer">
            <code id="filePreview">
            </code>
        </pre>

        <div id="map"></div>

        <hr>

        <p>
            Source code: <a href="https://github.com/TheStalwart/waze2gpx">https://github.com/TheStalwart/waze2gpx</a>
        </p>
    </body>

</html>

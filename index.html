<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>waze2gpx: Waze trip history to GPX converter</title>
        <script type="module" src="waze2gpx.js" defer></script>
        <link rel="stylesheet" href="layout.css">

        <!--
            Moment.js
            https://momentjs.com
        -->
        <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/moment.min.js"></script>

        <!--
            Leaflet
            https://leafletjs.com/examples/quick-start/
        -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    </head>

    <body>
        <h1>Convert Waze trip history to GPX file</h1>

        <h2>Step 1: Export personal data from Waze</h2>
        <p>
            Request and download data archive from <a href="https://www.waze.com/account/download_data">https://www.waze.com/account/download_data</a>,<br/>
            then extract the "account_activity_3.csv" file from password-protected archive
        </p>

        <h2>Step 2: Upload the account_activity_3.csv file</h2>
        <form id="fileForm">
            <label for="fileUpload">Choose a account_activity_3.csv file:</label>
            <input type="file" id="fileUpload" name="fileUpload" accept=".csv">
            <button type="submit">Upload</button>
            <span id="fileFormErrorBox"></span>
        </form>
        <div id="parsedTripCounterContainer">
            Uploaded trips: <span id="parsedTripCounter"></span>
        </div>

        <h2>Step 3: Trim data and adjust settings</h2>
        <p>
            <div>
                First trip start date: 
                <button id="startPrevTripButton" title="Previous trip" disabled>&lt;&lt;</button>
                <input type="datetime-local" id="startDateInput" name="start-date" disabled />
                <button id="startNextTripButton" title="Next trip" disabled>&gt;&gt;</button>
            </div>
            <div>
                Last trip start date: 
                <button id="endPrevTripButton" title="Previous trip" disabled>&lt;&lt;</button>
                <input type="datetime-local" id="endDateInput" name="end-date" disabled />
                <button id="endNextTripButton" title="Next trip" disabled>&gt;&gt;</button>
            </div>
            <div>
                Selected trips: <span id="selectedTripCounter"></span>
            </div>

            <div id="map"></div>
        </p>

        <h2>Step 4: Download trip data in GPX format</h2>
        <p>
            <div>
                <div id="gpxFileLinkContainer">
                    GPX file: <a id="downloadXmlLink" href="#" class="disabled">account_activity_3.gpx</a>
                    <span id="gpxFileSizeSpan">(0 MB)</span>
                </div>
                <div id="geoJSONFileLinkContainer">
                    GeoJSON file: <a id="downloadGeoJSONLink" href="#" class="disabled">account_activity_3.geojson</a>
                    <span id="geoJSONFileSizeSpan">(0 MB)</span>
                </div>
            </div>
        </p>

        <hr>

        <p>
            Source code: <a href="https://github.com/TheStalwart/waze2gpx">https://github.com/TheStalwart/waze2gpx</a>
        </p>
    </body>

</html>
